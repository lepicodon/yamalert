[
  {
    "id": "telegraf_host_up_down",
    "name": "Telegraf Host Up/Down",
    "job": "Telegraf",
    "description": "Alert when Telegraf agent is down for more than 2 minutes.",
    "alert_types": [
      "email",
      "interlink"
    ],
    "rules": [
      {
        "alert": "TelegrafHostDown",
        "expr": "up{job=\"telegraf\"} == 0",
        "for": "2m",
        "labels": {
          "severity": "critical"
        },
        "annotations": {
          "summary": "Telegraf agent down on {{ $labels.instance }}",
          "description": "Telegraf is not reporting metrics from {{ $labels.instance }}."
        },
        "linux_playbook": "Check service: systemctl status telegraf, Check logs: journalctl -u telegraf -n 50",
        "windows_playbook": "Check service: Get-Service telegraf, Check logs: Get-EventLog -LogName Application -Source telegraf -Newest 50",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "telegraf_cpu_high",
    "name": "Telegraf CPU High",
    "job": "Telegraf",
    "description": "Alert when CPU usage exceeds 80% for 5 minutes.",
    "alert_types": [
      "email"
    ],
    "rules": [
      {
        "alert": "CPUHigh",
        "expr": "100 - (avg by(instance) (rate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100) > 80",
        "for": "5m",
        "labels": {
          "severity": "warning"
        },
        "annotations": {
          "summary": "High CPU usage on {{ $labels.instance }}",
          "description": "CPU usage is above 80% (current: {{ $value }}%)"
        },
        "linux_playbook": "Check processes: top -b -n1 | head -20, Check load: uptime, Check cores: nproc",
        "windows_playbook": "Check processes: Get-Process | Sort-Object CPU -Descending | Select-Object -First 10, Check load: Get-WmiObject win32_processor -Property LoadPercentage",
        "value": "{{ $value }}"
      },
      {
        "alert": "CPUCritical",
        "expr": "100 - (avg by(instance) (rate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100) > 95",
        "for": "2m",
        "labels": {
          "severity": "critical"
        },
        "annotations": {
          "summary": "Critical CPU usage on {{ $labels.instance }}",
          "description": "CPU usage is above 95% (current: {{ $value }}%)"
        },
        "linux_playbook": "Check processes: top -b -n1 | head -20, Check load: uptime, Check cores: nproc",
        "windows_playbook": "Check processes: Get-Process | Sort-Object CPU -Descending | Select-Object -First 10, Check load: Get-WmiObject win32_processor -Property LoadPercentage",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "telegraf_memory_high",
    "name": "Telegraf Memory High",
    "job": "Telegraf",
    "description": "Alert when memory usage exceeds 85% for 5 minutes.",
    "alert_types": [
      "interlink"
    ],
    "rules": [
      {
        "alert": "MemoryHigh",
        "expr": "(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100 > 85",
        "for": "5m",
        "labels": {
          "severity": "warning"
        },
        "annotations": {
          "summary": "High memory usage on {{ $labels.instance }}",
          "description": "Memory usage is above 85% (current: {{ $value }}%)"
        },
        "linux_playbook": "Check memory: free -h, Check swap: swapon --show, Check top memory users: top -b -n1 | grep -E 'Mem|VIRT|RES'",
        "windows_playbook": "Check memory: Get-WmiObject win32_logicalmemoryconfigurations, Check memory: Get-Process | Sort-Object WS -Descending | Select-Object -First 10",
        "value": "{{ $value }}"
      },
      {
        "alert": "MemoryCritical",
        "expr": "(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100 > 95",
        "for": "2m",
        "labels": {
          "severity": "critical"
        },
        "annotations": {
          "summary": "Critical memory usage on {{ $labels.instance }}",
          "description": "Memory usage is above 95% (current: {{ $value }}%)"
        },
        "linux_playbook": "Check memory: free -h, Check swap: swapon --show, Check top memory users: top -b -n1 | grep -E 'Mem|VIRT|RES'",
        "windows_playbook": "Check memory: Get-WmiObject win32_logicalmemoryconfigurations, Check memory: Get-Process | Sort-Object WS -Descending | Select-Object -First 10",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "telegraf_disk_space_low",
    "name": "Telegraf Disk Space Low",
    "job": "Telegraf",
    "description": "Alert when disk usage exceeds 90% for 5 minutes.",
    "alert_types": [
      "eda"
    ],
    "rules": [
      {
        "alert": "DiskSpaceWarning",
        "expr": "(1 - (node_filesystem_avail_bytes / node_filesystem_size_bytes)) * 100 > 85",
        "for": "5m",
        "labels": {
          "severity": "warning"
        },
        "annotations": {
          "summary": "Low free space on {{ $labels.instance }} ({{ $labels.mountpoint }})",
          "description": "Disk usage above 85% (current: {{ $value }}%)"
        },
        "linux_playbook": "Check disk usage: df -h, Check inode usage: df -i, Check largest directories: du -sh /*",
        "windows_playbook": "Check disk usage: Get-Volume, Check C: drive: Get-Volume | Where-Object {$_.DriveLetter -eq 'C'}, Check largest dirs: Get-ChildItem C:\\ -Recurse -ErrorAction SilentlyContinue | Sort-Object Length -Descending | Select-Object -First 20",
        "value": "{{ $value }}"
      },
      {
        "alert": "DiskSpaceCritical",
        "expr": "(1 - (node_filesystem_avail_bytes / node_filesystem_size_bytes)) * 100 > 95",
        "for": "2m",
        "labels": {
          "severity": "critical"
        },
        "annotations": {
          "summary": "Critical: Disk full on {{ $labels.instance }} ({{ $labels.mountpoint }})",
          "description": "Disk usage above 95% (current: {{ $value }}%)"
        },
        "linux_playbook": "Check disk usage: df -h, Check inode usage: df -i, Check largest directories: du -sh /*",
        "windows_playbook": "Check disk usage: Get-Volume, Check C: drive: Get-Volume | Where-Object {$_.DriveLetter -eq 'C'}, Check largest dirs: Get-ChildItem C:\\ -Recurse -ErrorAction SilentlyContinue | Sort-Object Length -Descending | Select-Object -First 20",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "telegraf_network_interface_down",
    "name": "Telegraf Network Interface Down",
    "job": "Telegraf",
    "description": "Alert when network interface becomes down or errors increase rapidly.",
    "alert_types": [
      "email",
      "eda"
    ],
    "rules": [
      {
        "alert": "NetworkInterfaceDown",
        "expr": "node_network_up{device!~\"lo\"} == 0",
        "for": "2m",
        "labels": {
          "severity": "critical"
        },
        "annotations": {
          "summary": "Network interface {{ $labels.device }} down on {{ $labels.instance }}",
          "description": "Interface {{ $labels.device }} is not up"
        },
        "linux_playbook": "Check interfaces: ip link show, Check status: ethtool {{ interface }}, Check errors: ip -s link, Check network stack: cat /proc/net/dev",
        "windows_playbook": "Check interfaces: Get-NetAdapter, Check status: Get-NetAdapterStatistics, Check errors: netstat -e",
        "value": "{{ $value }}"
      },
      {
        "alert": "NetworkErrorsHigh",
        "expr": "rate(node_network_receive_errs_total[5m]) + rate(node_network_transmit_errs_total[5m]) > 10",
        "for": "5m",
        "labels": {
          "severity": "warning"
        },
        "annotations": {
          "summary": "High network errors on {{ $labels.instance }} ({{ $labels.device }})",
          "description": "Network errors detected: {{ $value }} errors/sec"
        },
        "linux_playbook": "Check interfaces: ip link show, Check status: ethtool {{ interface }}, Check errors: ip -s link, Check network stack: cat /proc/net/dev",
        "windows_playbook": "Check interfaces: Get-NetAdapter, Check status: Get-NetAdapterStatistics, Check errors: netstat -e",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "telegraf_host_uptime_low",
    "name": "Telegraf Host Uptime Low",
    "job": "Telegraf",
    "description": "Alert when host uptime is less than 1 hour (indicates recent reboot).",
    "alert_types": [
      "email",
      "interlink",
      "eda"
    ],
    "rules": [
      {
        "alert": "HostRecentlyRebooted",
        "expr": "node_boot_time_seconds > (time() - 3600)",
        "for": "0m",
        "labels": {
          "severity": "info"
        },
        "annotations": {
          "summary": "Host {{ $labels.instance }} was recently rebooted",
          "description": "Host has been up for less than 1 hour"
        },
        "linux_playbook": "Check uptime: uptime, Check last reboot: last reboot, Check systemd journals: journalctl --since '1 hour ago'",
        "windows_playbook": "Check uptime: systeminfo | find 'System Boot Time', Check event logs: Get-EventLog -LogName System -InstanceId 6005 -Newest 1",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "ping_host_down",
    "name": "Ping Host Down",
    "job": "Ping",
    "description": "Alert when ping probe fails for more than 2 minutes.",
    "alert_types": [
      "email",
      "eda"
    ],
    "rules": [
      {
        "alert": "PingHostDown",
        "expr": "probe_success{job=\"ping\"} == 0",
        "for": "2m",
        "labels": {
          "severity": "critical"
        },
        "annotations": {
          "summary": "Host {{ $labels.instance }} is unreachable",
          "description": "Ping probe failing for host {{ $labels.instance }}"
        },
        "linux_playbook": "Ping host: ping -c 5 {{ host }}, Check route: traceroute {{ host }}, Check firewall: sudo iptables -L -n | grep ICMP",
        "windows_playbook": "Ping host: ping {{ host }}, Tracert: tracert {{ host }}, Check firewall: netsh advfirewall show allprofiles",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "ping_latency_high",
    "name": "Ping Latency High",
    "job": "Ping",
    "description": "Alert when average ping latency exceeds 200ms for 5 minutes.",
    "alert_types": [
      "interlink"
    ],
    "rules": [
      {
        "alert": "PingLatencyWarning",
        "expr": "probe_duration_seconds{job=\"ping\"} > 0.1",
        "for": "5m",
        "labels": {
          "severity": "warning"
        },
        "annotations": {
          "summary": "High latency to {{ $labels.instance }}",
          "description": "Ping latency above 100ms (current: {{ $value | humanizeDuration }})"
        },
        "linux_playbook": "Ping with timing: ping -c 10 {{ host }}, Check route latency: traceroute -w 1 {{ host }}, Check network stats: ss -i",
        "windows_playbook": "Ping with timing: ping -n 10 {{ host }}, Check network stats: netstat -ano | findstr ESTABLISHED",
        "value": "{{ $value }}"
      },
      {
        "alert": "PingLatencyCritical",
        "expr": "probe_duration_seconds{job=\"ping\"} > 0.5",
        "for": "2m",
        "labels": {
          "severity": "critical"
        },
        "annotations": {
          "summary": "Critical latency to {{ $labels.instance }}",
          "description": "Ping latency above 500ms (current: {{ $value | humanizeDuration }})"
        },
        "linux_playbook": "Ping with timing: ping -c 10 {{ host }}, Check route latency: traceroute -w 1 {{ host }}, Check network stats: ss -i",
        "windows_playbook": "Ping with timing: ping -n 10 {{ host }}, Check network stats: netstat -ano | findstr ESTABLISHED",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "vmware_vm_cpu_high",
    "name": "VMware VM CPU High",
    "job": "VMware",
    "description": "Alert when VM CPU usage exceeds 80% for 5 minutes.",
    "alert_types": [
      "eda"
    ],
    "rules": [
      {
        "alert": "VMCPUHigh",
        "expr": "vmware_vm_cpu_usage_percent > 80",
        "for": "5m",
        "labels": {
          "severity": "warning"
        },
        "annotations": {
          "summary": "High CPU on VM {{ $labels.vm_name }} ({{ $labels.host }})",
          "description": "VM CPU usage above 80% (current: {{ $value }}%)"
        },
        "linux_playbook": "SSH to VM: ssh {{ vm_ip }}, Check CPU: top -b -n1 | head -20",
        "windows_playbook": "RDP to VM, Check CPU: Get-Process | Sort-Object CPU -Descending | Select-Object -First 10",
        "value": "{{ $value }}"
      },
      {
        "alert": "VMCPUCritical",
        "expr": "vmware_vm_cpu_usage_percent > 95",
        "for": "2m",
        "labels": {
          "severity": "critical"
        },
        "annotations": {
          "summary": "Critical CPU on VM {{ $labels.vm_name }} ({{ $labels.host }})",
          "description": "VM CPU usage above 95% (current: {{ $value }}%)"
        },
        "linux_playbook": "SSH to VM: ssh {{ vm_ip }}, Check CPU: top -b -n1 | head -20",
        "windows_playbook": "RDP to VM, Check CPU: Get-Process | Sort-Object CPU -Descending | Select-Object -First 10",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "vmware_vm_memory_high",
    "name": "VMware VM Memory High",
    "job": "VMware",
    "description": "Alert when VM memory usage exceeds 85% for 5 minutes.",
    "alert_types": [
      "email",
      "interlink",
      "eda"
    ],
    "rules": [
      {
        "alert": "VMMemoryHigh",
        "expr": "vmware_vm_memory_usage_percent > 85",
        "for": "5m",
        "labels": {
          "severity": "warning"
        },
        "annotations": {
          "summary": "High memory on VM {{ $labels.vm_name }} ({{ $labels.host }})",
          "description": "VM memory usage above 85% (current: {{ $value }}%)"
        },
        "linux_playbook": "SSH to VM: ssh {{ vm_ip }}, Check memory: free -h, Check top memory users: top -b -n1 | grep -E 'Mem|RES'",
        "windows_playbook": "RDP to VM, Check memory: Get-WmiObject win32_logicalmemoryconfigurations, Check processes: Get-Process | Sort-Object WS -Descending | Select-Object -First 10",
        "value": "{{ $value }}"
      },
      {
        "alert": "VMMemoryCritical",
        "expr": "vmware_vm_memory_usage_percent > 95",
        "for": "2m",
        "labels": {
          "severity": "critical"
        },
        "annotations": {
          "summary": "Critical memory on VM {{ $labels.vm_name }} ({{ $labels.host }})",
          "description": "VM memory usage above 95% (current: {{ $value }}%)"
        },
        "linux_playbook": "SSH to VM: ssh {{ vm_ip }}, Check memory: free -h, Check top memory users: top -b -n1 | grep -E 'Mem|RES'",
        "windows_playbook": "RDP to VM, Check memory: Get-WmiObject win32_logicalmemoryconfigurations, Check processes: Get-Process | Sort-Object WS -Descending | Select-Object -First 10",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "vmware_host_cpu_high",
    "name": "VMware Host CPU High",
    "job": "VMware",
    "description": "Alert when ESX host CPU usage exceeds 80% for 5 minutes.",
    "alert_types": [
      "email"
    ],
    "rules": [
      {
        "alert": "HostCPUHigh",
        "expr": "vmware_host_cpu_usage_percent > 80",
        "for": "5m",
        "labels": {
          "severity": "warning"
        },
        "annotations": {
          "summary": "High CPU on ESX host {{ $labels.host_name }}",
          "description": "Host CPU usage above 80% (current: {{ $value }}%)"
        },
        "linux_playbook": "SSH to ESX: ssh root@{{ host }}, Check CPU: esxcli hardware cpu global get, Check processes: esxtop",
        "windows_playbook": "N/A - ESX hosts are Linux-based",
        "value": "{{ $value }}"
      },
      {
        "alert": "HostCPUCritical",
        "expr": "vmware_host_cpu_usage_percent > 90",
        "for": "2m",
        "labels": {
          "severity": "critical"
        },
        "annotations": {
          "summary": "Critical CPU on ESX host {{ $labels.host_name }}",
          "description": "Host CPU usage above 90% (current: {{ $value }}%)"
        },
        "linux_playbook": "SSH to ESX: ssh root@{{ host }}, Check CPU: esxcli hardware cpu global get, Check processes: esxtop",
        "windows_playbook": "N/A - ESX hosts are Linux-based",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "vmware_host_memory_high",
    "name": "VMware Host Memory High",
    "job": "VMware",
    "description": "Alert when ESX host memory usage exceeds 85% for 5 minutes.",
    "alert_types": [
      "interlink",
      "eda"
    ],
    "rules": [
      {
        "alert": "HostMemoryHigh",
        "expr": "vmware_host_memory_usage_percent > 85",
        "for": "5m",
        "labels": {
          "severity": "warning"
        },
        "annotations": {
          "summary": "High memory on ESX host {{ $labels.host_name }}",
          "description": "Host memory usage above 85% (current: {{ $value }}%)"
        },
        "linux_playbook": "SSH to ESX: ssh root@{{ host }}, Check memory: esxcli hardware memory get, Check free memory: esxtop",
        "windows_playbook": "N/A - ESX hosts are Linux-based",
        "value": "{{ $value }}"
      },
      {
        "alert": "HostMemoryCritical",
        "expr": "vmware_host_memory_usage_percent > 95",
        "for": "2m",
        "labels": {
          "severity": "critical"
        },
        "annotations": {
          "summary": "Critical memory on ESX host {{ $labels.host_name }}",
          "description": "Host memory usage above 95% (current: {{ $value }}%)"
        },
        "linux_playbook": "SSH to ESX: ssh root@{{ host }}, Check memory: esxcli hardware memory get, Check free memory: esxtop",
        "windows_playbook": "N/A - ESX hosts are Linux-based",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "vmware_datastore_space_low",
    "name": "VMware Datastore Space Low",
    "job": "VMware",
    "description": "Alert when datastore usage exceeds 85% for 5 minutes.",
    "alert_types": [
      "email"
    ],
    "rules": [
      {
        "alert": "DatastoreWarning",
        "expr": "vmware_datastore_capacity_percent > 85",
        "for": "5m",
        "labels": {
          "severity": "warning"
        },
        "annotations": {
          "summary": "Low free space on datastore {{ $labels.datastore }} ({{ $labels.cluster }})",
          "description": "Datastore usage above 85% (current: {{ $value }}%)"
        },
        "linux_playbook": "SSH to vCenter: ssh root@{{ vcenter }}, Check datastores: esxcli storage filesystem list, Check space: vim-cmd hostsvc/datastore/info",
        "windows_playbook": "Use vSphere Client, Navigate to Storage > Datastores, Check free space and capacity",
        "value": "{{ $value }}"
      },
      {
        "alert": "DatastoreCritical",
        "expr": "vmware_datastore_capacity_percent > 95",
        "for": "2m",
        "labels": {
          "severity": "critical"
        },
        "annotations": {
          "summary": "Critical: Datastore {{ $labels.datastore }} almost full ({{ $labels.cluster }})",
          "description": "Datastore usage above 95% (current: {{ $value }}%)"
        },
        "linux_playbook": "SSH to vCenter: ssh root@{{ vcenter }}, Check datastores: esxcli storage filesystem list, Check space: vim-cmd hostsvc/datastore/info",
        "windows_playbook": "Use vSphere Client, Navigate to Storage > Datastores, Check free space and capacity",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "ssl_certificate_expiring_soon_15_days",
    "name": "SSL Certificate Expiring Soon (15 days)",
    "job": "SSL",
    "description": "Alert when SSL certificate expires within 15 days.",
    "alert_types": [
      "eda"
    ],
    "rules": [
      {
        "alert": "SSLCertExpiring15d",
        "expr": "probe_ssl_earliest_cert_expiry - time() < 15 * 24 * 3600",
        "for": "1h",
        "labels": {
          "severity": "warning"
        },
        "annotations": {
          "summary": "SSL certificate expiring soon: {{ $labels.instance }}",
          "description": "Certificate expires in {{ $value | humanizeDuration }}"
        },
        "linux_playbook": "Check cert: openssl s_client -connect {{ domain }}:443 -showcerts, Check expiry: openssl x509 -in {{ cert_file }} -noout -dates",
        "windows_playbook": "Check cert: certlm.msc (Local Machine > Personal > Certificates), Check expiry: Get-ChildItem Cert:\\LocalMachine\\My | Where-Object { $_.NotAfter -lt (Get-Date).AddDays(15) }",
        "value": "{{ $value }}"
      }
    ]
  },
  {
    "id": "ssl_certificate_expired",
    "name": "SSL Certificate Expired",
    "job": "SSL",
    "description": "Alert when SSL certificate has expired.",
    "alert_types": [
      "email",
      "interlink"
    ],
    "rules": [
      {
        "alert": "SSLCertExpired",
        "expr": "probe_ssl_earliest_cert_expiry - time() <= 0",
        "for": "0m",
        "labels": {
          "severity": "critical"
        },
        "annotations": {
          "summary": "SSL certificate EXPIRED: {{ $labels.instance }}",
          "description": "Certificate expired {{ $value | humanizeDuration }} ago"
        },
        "linux_playbook": "Renew cert: certbot renew, Check cert: openssl x509 -in {{ cert_file }} -noout -dates, Restart service: systemctl restart nginx/apache2",
        "windows_playbook": "Renew cert: Use Let's Encrypt ACME client or manual renewal, Replace cert: iisreset, Import cert: certlm.msc",
        "value": "{{ $value }}"
      }
    ]
  }
]